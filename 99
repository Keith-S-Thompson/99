#!/usr/bin/perl

# $Id: 99,v 1.3 2011-05-17 15:51:43 kst Exp $
# $Source: /home/kst/CVS_99/99/99,v $

#
# Interpreter for the "99" programming language.
#

use strict;
use warnings;

my $error_line = undef;

#
# Check for errors.
#
while (<>) {
    s/#.*$//;
    s/^\s*//;
    s/\s*$//;
    defined $error_line or $error_line = $. if /./;
}

die "Syntax error on line $error_line\n" if defined $error_line;

#
# "Run" the "program".
#
for (my $i = 99; $i >= 0; $i --) {
    my $s   = $i == 1 ? ''   : 's';
    my $num = $i == 0 ? 'No' : $i;
    my $one = $i == 1 ? 'it' : 'one';
    my $bottles = "$num bottle$s of beer";
    my $take = "Take $one down, pass it around";
    print "$bottles on the wall.\n" if $i < 99;
    print "\n" if $i % 99;
    print "$bottles on the wall,\n$bottles.\n$take,\n" if $i;
}
